var progressContainer=$(".progress");var progressbar=$(".progress-bar");var fileInput=document.getElementById("file-input");var dropZone=document.getElementById("dropzone");loadImageList("all");function upload(a){var b=new FormData();b.append("file",a);$(".upload-file").hide();$.ajax({url:window.location.href+"index.php/upload/do_upload",data:b,cache:false,contentType:false,processData:false,type:"post",xhr:function(){var c=null;if(window.ActiveXObject){c=new window.ActiveXObject("Microsoft.XMLHTTP")}else{c=new window.XMLHttpRequest()}progressContainer.show();progressbar.show();c.upload.addEventListener("progress",countProgress,false);return c}}).done(function(){setTimeout(function(){showProgress(0);progressContainer.hide();progressbar.hide();$(".upload-file").show();loadImageList("last")},2500)}).fail(function(){showError("A kép feltöltése nem sikerült");$(".upload-file").show()})}function countProgress(a){if(a.lengthComputable){var b=Math.round((a.loaded*100)/a.total);showProgress(b)}}function showProgress(a){progressbar.attr("aria-valuenow",a);progressbar.css("width",a+"%");progressbar.text(a+"%")}function handleFileSelect(a){a.stopPropagation();a.preventDefault();var b=a.dataTransfer.files;checkFiles(b)}function handleDragOver(a){a.stopPropagation();a.preventDefault();a.dataTransfer.dropEffect="copy"}function handlefileInputChange(a){var b=fileInput.files;checkFiles(b)}function checkFiles(a){if(a.length>1){showError("Csak egy fájl feltöltése lehetséges!");return}if(validateFileExtension(a[0])){upload(a[0])}else{showError("Nem megfeleő kép formátum, csak kép feltöltése lehetséges!")}}function showError(b){var a=$("#error-message");a.text(b);a.show();setTimeout(function(){a.hide()},2500)}function validateFileExtension(b){var a=b.name.toLowerCase();console.log(a);if(a.endsWith(".gif")||a.endsWith(".jpg")||a.endsWith(".jpeg")||a.endsWith(".png")){return true}return false}dropZone.addEventListener("dragover",handleDragOver,false);dropZone.addEventListener("drop",handleFileSelect,false);fileInput.addEventListener("change",handlefileInputChange,false);function loadImageList(a){$.ajax({url:window.location.href+"index.php/upload/list_uploads",data:{},cache:false,contentType:false,processData:false}).done(function(b){var d=JSON.parse(b);var c=$.map(d,function(f,e){return[f]});showImages(c,a)}).fail(function(){showError("A kép(ek) betöltése nem sikerült")})}function showImage(b,c){var d=window.location.href+"/uploads/"+c;var a=$('<div class="col-md-2 col-sm-4 col-xs-6"><div class="thumbnail" ><a href="'+d+'" target="_blank"><img class="img-compressed" src="'+d+'" style="width:150px; height: 150px"></a></div></div>');a.show();b.append(a)}function showImages(d,c){var a=$(".gallery-row");if(c==="all"){for(var b=0;b<d.length;b++){showImage(a,d[b])}}if(c==="last"){showImage(a,d[d.length-1])}};